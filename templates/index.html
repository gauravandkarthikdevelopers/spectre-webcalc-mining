<!DOCTYPE html>
<html>
<head>
    <title>Mining Rewards Calculator</title>
    <!-- Import Materialize CSS and icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f5f5f5; }
        .container { margin-top: 50px; }
        .card { padding: 20px; }
        .card-content { padding-bottom: 0; }
        .result { margin-top: 20px; }
        .card-title { margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col s12 m8 offset-m2">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">Mining Rewards Calculator</span>
                        <form id="calcForm">
                            <div class="input-field">
                                <i class="material-icons prefix">speed</i>
                                <input type="number" id="hashrate" name="hashrate" required>
                                <label for="hashrate">Mining Hashrate (kH/s)</label>
                            </div>
                            <div class="center-align">
                                <button class="btn waves-effect waves-light" type="submit">
                                    Calculate
                                    <i class="material-icons right">calculate</i>
                                </button>
                            </div>
                        </form>
                        <div id="results" class="result"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Import jQuery and Materialize JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#calcForm').on('submit', function(event) {
                event.preventDefault();
                const hashrate = $('#hashrate').val();

                $.ajax({
                    url: '/get_rewards',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ own_hashrate_khs: parseFloat(hashrate) }),
                    success: function(data) {
                        if (data.error) {
                            $('#results').html(`<p class="red-text">${data.error}</p>`);
                        } else {
                            const { network_hashrate_mhs, blockreward, percent_of_network, rewards } = data;
                            let resultHTML = `
                                <div class="card-panel">
                                    <div class="row">
                                        <div class="col s12">
                                            <h5>Network Statistics</h5>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Current Network Hashrate:</strong></p>
                                            <p>${network_hashrate_mhs.toFixed(2)} MH/s</p>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Block Reward:</strong></p>
                                            <p>${blockreward} SPR</p>
                                        </div>
                                        <div class="col s12">
                                            <p><strong>Your Portion of the Network Hashrate:</strong></p>
                                            <p>${(percent_of_network * 100).toFixed(9)}%</p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col s12">
                                            <h5>Estimated Rewards</h5>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Per second:</strong></p>
                                            <p>${rewards.second.toFixed(6)} SPR</p>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Per minute:</strong></p>
                                            <p>${rewards.minute.toFixed(6)} SPR</p>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Per hour:</strong></p>
                                            <p>${rewards.hour.toFixed(6)} SPR</p>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Per day:</strong></p>
                                            <p>${rewards.day.toFixed(6)} SPR</p>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Per week:</strong></p>
                                            <p>${rewards.week.toFixed(6)} SPR</p>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Per month:</strong></p>
                                            <p>${rewards.month.toFixed(6)} SPR</p>
                                        </div>
                                        <div class="col s12 m6">
                                            <p><strong>Per year:</strong></p>
                                            <p>${rewards.year.toFixed(6)} SPR</p>
                                        </div>
                                    </div>
                                </div>`;
                            $('#results').html(resultHTML);
                        }
                    },
                    error: function(error) {
                        $('#results').html(`<p class="red-text">Error: ${error.responseText}</p>`);
                    }
                });
            });
        });
    </script>
</body>
</html>
